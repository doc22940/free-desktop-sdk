Manually rebased from https://sqlite.org/src/vpatch?from=45c73deb440496e8&to=b3fa58dd7403dbd4

diff -ur sqlite.old/sqlite3.c sqlite/sqlite3.c
--- sqlite.old/sqlite3.c	2019-09-26 15:35:17.176225451 +0200
+++ sqlite/sqlite3.c	2019-09-26 15:35:59.643838632 +0200
@@ -207767,7 +207767,9 @@
   for(iSlot=0; iSlot<pHash->nSlot; iSlot++){
     Fts5HashEntry *pIter;
     for(pIter=pHash->aSlot[iSlot]; pIter; pIter=pIter->pHashNext){
-      if( pTerm==0 || 0==memcmp(fts5EntryKey(pIter), pTerm, nTerm) ){
+      if( pTerm==0 
+       || (pIter->nKey+1>=nTerm && 0==memcmp(fts5EntryKey(pIter), pTerm, nTerm))
+      ){
         Fts5HashEntry *pEntry = pIter;
         pEntry->pScanNext = 0;
         for(i=0; ap[i]; i++){
